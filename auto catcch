local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Islands = Workspace:WaitForChild("Islands")
local EventsFolder = ReplicatedStorage:WaitForChild("Communication", 9e9):WaitForChild("Events", 9e9)

-- Find the correct RemoteEvent
local remote
for _, evt in ipairs(EventsFolder:GetChildren()) do
    if evt:IsA("RemoteEvent") and evt.Name ~= "" then
        remote = evt
        break
    end
end

-- Tool UUIDs to try
local TOOL_UUIDS = {
    "{4ba69e17-8de2-43a2-ac9a-f1d1e425be9b}",
    "{634dc3c2-1694-4273-92d2-adf8f7ade91f}",
    "{51ba4466-f758-4d1c-970d-aad27326dbaf}",
    "{06905d54-7826-417e-bfc7-82d326a30885}",
    "{7138d7c4-9482-4257-868c-4bd1fd99f529}",
    "{5dab28e4-4bfb-430b-86fe-530bafa237b5}",
}

-- Excluded names
local exclusions = {
    ["{c91d0e3a-e8c6-4e70-b274-9b7304ffbb28}"] = true,
    ["Horse"] = true,
    ["Travel Boat"] = true,
}

-- Helper
local function isUUID(str)
    return typeof(str) == "string" and str:match("^%b{}$") ~= nil
end

local function getPlayerPos()
    local root = Character:FindFirstChild("HumanoidRootPart")
    return root and root.Position
end

local function tryCatch(target)
    for _, uuid in ipairs(TOOL_UUIDS) do
        remote:FireServer(uuid, "Activate", target)
        task.wait(0.05)
    end
end

-- Main loop
task.spawn(function()
    while true do
        local pos = getPlayerPos()
        if pos then
            -- Check Island animals
            for _, island in ipairs(Islands:GetChildren()) do
                for _, model in ipairs(island:GetChildren()) do
                    if isUUID(model.Name) and not exclusions[model.Name] and model:FindFirstChild("Body") then
                        local dist = (model.Body.Position - pos).Magnitude
                        if dist < 15 then
                            tryCatch(model)
                        end
                    end
                end
            end

            -- Check Workspace animals
            for _, model in ipairs(Workspace:GetChildren()) do
                if isUUID(model.Name) and not exclusions[model.Name] and model:FindFirstChild("Body") then
                    local dist = (model.Body.Position - pos).Magnitude
                    if dist < 15 then
                        tryCatch(model)
                    end
                end
            end
        end
        task.wait(0.1)
    end
end)
