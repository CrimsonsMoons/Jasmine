local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local boxFolderName = "BoxTrap"

local function createBoxAroundCharacter(char)
	local root = char:WaitForChild("HumanoidRootPart")

	local boxSize = Vector3.new(15, 15, 15) -- Size of the entire box
	local thickness = 0.1 -- Wall thickness
	local height = boxSize.Y

	local partsFolder = Instance.new("Folder")
	partsFolder.Name = boxFolderName
	partsFolder.Parent = workspace

	-- Helper to create a wall part
	local function createWall(position, size)
		local part = Instance.new("Part")
		part.Anchored = true
		part.CanCollide = true
		part.Size = size
		part.Position = position
		part.Transparency = 0.3
		part.Color = Color3.new(1, 0, 0) -- Red
		part.Parent = partsFolder
		return part
	end

	local rootPos = root.Position

	-- Create 4 walls
	createWall(rootPos + Vector3.new(boxSize.X / 2, height / 2, 0), Vector3.new(thickness, height, boxSize.Z)) -- Right
	createWall(rootPos - Vector3.new(boxSize.X / 2, -height / 2, 0), Vector3.new(thickness, height, boxSize.Z)) -- Left
	createWall(rootPos + Vector3.new(0, height / 2, boxSize.Z / 2), Vector3.new(boxSize.X, height, thickness)) -- Front
	createWall(rootPos - Vector3.new(0, -height / 2, boxSize.Z / 2), Vector3.new(boxSize.X, height, thickness)) -- Back

	-- Floor and ceiling
	createWall(rootPos - Vector3.new(0, height / 2, 0), Vector3.new(boxSize.X, thickness, boxSize.Z)) -- Floor
	createWall(rootPos + Vector3.new(0, height / 2, 0), Vector3.new(boxSize.X, thickness, boxSize.Z)) -- Ceiling
end

-- Destroy the box if it exists
local function destroyBox()
	local box = workspace:FindFirstChild(boxFolderName)
	if box then
		box:Destroy()
		print("Box destroyed.")
	end
end

-- Handle keybind
UserInputService.InputBegan:Connect(function(input, isTyping)
	if isTyping then return end
	if input.KeyCode == Enum.KeyCode.K then
		destroyBox()
	end
end)

-- Main
local character = player.Character or player.CharacterAdded:Wait()
createBoxAroundCharacter(character)

-- Recreate box on respawn
player.CharacterAdded:Connect(function(char)
	task.wait(1)
	destroyBox()
	createBoxAroundCharacter(char)
end)
