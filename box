local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local boxFolderName = "BoxTrap"

local function createBoxAroundCharacter(char)
	local root = char:WaitForChild("HumanoidRootPart")

	local baseSize = Vector3.new(10, 1, 10) -- Floor size
	local wallHeight = 80 -- Very tall walls
	local ceilingHeightOffset = 40 -- Distance from center to ceiling
	local wallOffset = 6 -- How far out walls are from center
	local wallThickness = 0.2

	local partsFolder = Instance.new("Folder")
	partsFolder.Name = boxFolderName
	partsFolder.Parent = workspace

	local function createWall(position, size)
		local part = Instance.new("Part")
		part.Anchored = true
		part.CanCollide = true
		part.Size = size
		part.Position = position
		part.Transparency = 0.3
		part.Color = Color3.new(1, 0, 0)
		part.Material = Enum.Material.Neon
		part.Parent = partsFolder
	end

	local rootPos = root.Position

	-- Floor
	createWall(rootPos - Vector3.new(0, 2, 0), baseSize)

	-- Walls (tall, offset slightly outward)
	createWall(rootPos + Vector3.new(wallOffset, wallHeight / 2, 0), Vector3.new(wallThickness, wallHeight, baseSize.Z + 4))
	createWall(rootPos - Vector3.new(wallOffset, -wallHeight / 2, 0), Vector3.new(wallThickness, wallHeight, baseSize.Z + 4))
	createWall(rootPos + Vector3.new(0, wallHeight / 2, wallOffset), Vector3.new(baseSize.X + 4, wallHeight, wallThickness))
	createWall(rootPos - Vector3.new(0, -wallHeight / 2, wallOffset), Vector3.new(baseSize.X + 4, wallHeight, wallThickness))

	-- Raised ceiling
	createWall(rootPos + Vector3.new(0, ceilingHeightOffset + wallHeight / 2, 0), baseSize + Vector3.new(4, 0, 4))
end

-- Destroy the box if it exists
local function destroyBox()
	local box = workspace:FindFirstChild(boxFolderName)
	if box then
		box:Destroy()
		print("Box destroyed.")
	end
end

-- Keybind to destroy with K
UserInputService.InputBegan:Connect(function(input, isTyping)
	if isTyping then return end
	if input.KeyCode == Enum.KeyCode.K then
		destroyBox()
	end
end)

-- Main
local character = player.Character or player.CharacterAdded:Wait()
createBoxAroundCharacter(character)

-- Recreate box on respawn
player.CharacterAdded:Connect(function(char)
	task.wait(1)
	destroyBox()
	createBoxAroundCharacter(char)
end)
