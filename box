local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local boxFolderName = "BoxTrap"

local function createBoxAroundCharacter(char)
	local root = char:WaitForChild("HumanoidRootPart")

	local boxWidth = 50
	local boxDepth = 50
	local boxHeight = 100
	local wallThickness = 1

	local partsFolder = Instance.new("Folder")
	partsFolder.Name = boxFolderName
	partsFolder.Parent = workspace

	local function createWall(position, size)
		local part = Instance.new("Part")
		part.Anchored = true
		part.CanCollide = true
		part.Size = size
		part.Position = position
		part.Transparency = 0.3
		part.Color = Color3.new(1, 0, 0) -- Red
		part.Material = Enum.Material.Neon
		part.Parent = partsFolder
	end

	local rootPos = root.Position
	local halfW, halfD, halfH = boxWidth / 2, boxDepth / 2, boxHeight / 2

	-- Floor
	createWall(rootPos - Vector3.new(0, halfH, 0), Vector3.new(boxWidth, wallThickness, boxDepth))

	-- Ceiling
	createWall(rootPos + Vector3.new(0, halfH, 0), Vector3.new(boxWidth, wallThickness, boxDepth))

	-- Walls
	createWall(rootPos + Vector3.new(halfW, 0, 0), Vector3.new(wallThickness, boxHeight, boxDepth)) -- Right
	createWall(rootPos - Vector3.new(halfW, 0, 0), Vector3.new(wallThickness, boxHeight, boxDepth)) -- Left
	createWall(rootPos + Vector3.new(0, 0, halfD), Vector3.new(boxWidth, boxHeight, wallThickness)) -- Front
	createWall(rootPos - Vector3.new(0, 0, halfD), Vector3.new(boxWidth, boxHeight, wallThickness)) -- Back
end

-- Destroy the box if it exists
local function destroyBox()
	local box = workspace:FindFirstChild(boxFolderName)
	if box then
		box:Destroy()
		print("Box destroyed.")
	end
end

-- Keybind to destroy with K
UserInputService.InputBegan:Connect(function(input, isTyping)
	if isTyping then return end
	if input.KeyCode == Enum.KeyCode.K then
		destroyBox()
	end
end)

-- Main
local character = player.Character or player.CharacterAdded:Wait()
createBoxAroundCharacter(character)

-- Recreate box on respawn
player.CharacterAdded:Connect(function(char)
	task.wait(1)
	destroyBox()
	createBoxAroundCharacter(char)
end)
