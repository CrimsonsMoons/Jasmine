-- SERVICES
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

-- üß† DYNAMIC SELL REMOTE DETECTION
local function getSellItemsRemote()
    local events = ReplicatedStorage:WaitForChild("Communication"):WaitForChild("Events")
    for _, remote in ipairs(events:GetChildren()) do
        if remote:IsA("RemoteEvent") then
            -- Try calling it with fake data to check response
            local success = pcall(function()
                remote:FireServer("SellItems", {})
            end)
            if success then
                print("‚úÖ Found SellItems Remote:", remote:GetFullName())
                return remote
            end
        end
    end
    error("‚ùå Could not find SellItems RemoteEvent.")
end

local sellRemote = getSellItemsRemote()

-- üîç UUID ITEMS LIST LOCATION
local function getUUIDListFolder()
    local contentList = LocalPlayer:WaitForChild("PlayerGui")
        :WaitForChild("Menus")
        :WaitForChild("Backpack")
        :WaitForChild("Main")
        :WaitForChild("Inventory")
        :WaitForChild("Content")
        :WaitForChild("List")

    local ninthSlot = contentList:GetChildren()[9]
    return ninthSlot and ninthSlot:FindFirstChild("List")
end

-- üßπ UUID FORMAT CHECK
local function isUUID(str)
    return typeof(str) == "string" and str:match("^%b{}$") ~= nil
end

-- üí∞ BUILD SELL TABLE (skipping Locked & Special)
local function buildSellTable()
    local sellTable = {}
    local listFolder = getUUIDListFolder()
    if not listFolder then return {} end

    for _, item in ipairs(listFolder:GetChildren()) do
        if isUUID(item.Name)
            and not item:FindFirstChild("Locked")
            and not item:FindFirstChild("SpecialIndicator") then
            sellTable[item.Name] = 1
        end
    end

    return sellTable
end

-- üß† SELL FUNCTION
local function sellAllUnlocked()
    local sellTable = buildSellTable()
    if next(sellTable) then
        local args = {
            [1] = "SellItems",
            [2] = sellTable
        }
        sellRemote:FireServer(unpack(args))
        print("‚úÖ Auto-sold items:", sellTable)
    else
        warn("‚ö†Ô∏è No sellable items (Locked or Special).")
    end
end

-- üîÅ AUTO SELL LOOP
local INTERVAL = 5 -- Seconds
task.spawn(function()
    while true do
        sellAllUnlocked()
        task.wait(INTERVAL)
    end
end)
